2026-01-16 19:18:16,743 - INFO - __main__ - Logging initialized. Log file: output/logs/main_20260116_191816.log
2026-01-16 19:18:16,743 - INFO - __main__ - ======================================================================
2026-01-16 19:18:16,743 - INFO - __main__ - IRP RESEARCH PIPELINE
2026-01-16 19:18:16,743 - INFO - __main__ - AI-Powered Log Analysis for Smarter Threat Detection
2026-01-16 19:18:16,743 - INFO - __main__ - ======================================================================
2026-01-16 19:18:16,743 - INFO - __main__ - Output directory: /home/tor/ton_iot/ton_iot/output
2026-01-16 19:18:16,743 - INFO - __main__ - Timestamp: 2026-01-16 19:18:16
2026-01-16 19:18:16,743 - INFO - __main__ - Checking Python dependencies from requirements.txt...
2026-01-16 19:18:17,753 - INFO - __main__ - All required packages are installed.
2026-01-16 19:18:17,753 - INFO - __main__ - Running complete pipeline (Phases 1, 3, 5)
2026-01-16 19:18:22,151 - INFO - main_pipeline - Pipeline initialized with output directory: /home/tor/ton_iot/ton_iot/output
2026-01-16 19:18:22,151 - INFO - __main__ - Starting complete pipeline execution...
2026-01-16 19:18:22,151 - INFO - main_pipeline - ============================================================
2026-01-16 19:18:22,151 - INFO - main_pipeline - PHASE 1: Preprocessing Configuration Selection
2026-01-16 19:18:22,151 - INFO - main_pipeline - ============================================================
2026-01-16 19:18:22,151 - INFO - main_pipeline - 
1.1 Loading datasets...
2026-01-16 19:18:22,151 - INFO - dataset_loader - Loading TON_IoT dataset from: datasets/ton_iot/train_test_network.csv
2026-01-16 19:18:22,767 - INFO - dataset_loader - TON_IoT loaded: 211043 rows, 44 columns
2026-01-16 19:18:22,767 - INFO - main_pipeline -    TON_IoT: (211043, 44)
2026-01-16 19:18:22,768 - INFO - dataset_loader - Found 1 CSV files in CIC-DDoS2019 dataset
2026-01-16 19:18:22,774 - INFO - dataset_loader - Concatenating all CSV files...
2026-01-16 19:18:22,774 - INFO - dataset_loader - CIC-DDoS2019 loaded: 11 rows, 85 columns
2026-01-16 19:18:22,774 - INFO - main_pipeline -    CIC-DDoS2019: (11, 85)
2026-01-16 19:18:22,774 - INFO - main_pipeline - 
1.2 Harmonizing datasets...
2026-01-16 19:18:22,774 - INFO - main_pipeline -    Mapping features between TON_IoT and CIC-DDoS2019...
2026-01-16 19:18:23,241 - INFO - main_pipeline -    CIC-DDoS2019 harmonized: (11, 8)
2026-01-16 19:18:23,241 - INFO - main_pipeline -    TON_IoT harmonized: (211043, 8)
2026-01-16 19:18:23,241 - INFO - main_pipeline - 
1.3 Early fusion...
2026-01-16 19:18:23,241 - INFO - main_pipeline -    Performing statistical validation (Kolmogorov-Smirnov test)...
2026-01-16 19:18:23,317 - INFO - main_pipeline -    Fused dataset: (211054, 9)
2026-01-16 19:18:23,318 - INFO - main_pipeline -    Validation: 2/7 features compatible
2026-01-16 19:18:23,322 - INFO - main_pipeline -    Features shape: (211054, 7), Labels shape: (211054,)
2026-01-16 19:18:23,322 - INFO - main_pipeline - 
1.4 Preprocessing (SMOTE + RobustScaler)...
2026-01-16 19:18:23,322 - INFO - main_pipeline -    Applying SMOTE for class balancing...
2026-01-16 19:18:23,322 - INFO - main_pipeline -    Scaling features with RobustScaler...
2026-01-16 19:18:24,613 - INFO - main_pipeline -    Processed shape: (322106, 7)
2026-01-16 19:18:24,618 - INFO - main_pipeline -    Class distribution: {0: 161053, 1: 161053}
2026-01-16 19:18:26,772 - INFO - main_pipeline - 
   Saved preprocessed data to output/phase1_preprocessing/preprocessed_data.csv
2026-01-16 19:18:26,782 - INFO - main_pipeline - 
3.1 Evaluating 5 algorithms with 5-fold CV...
2026-01-16 19:18:26,783 - INFO - main_pipeline - 
   Evaluating Logistic Regression...
2026-01-16 19:18:26,820 - WARNING - main_pipeline -       Error in fold 1 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:26,837 - WARNING - main_pipeline -       Error in fold 2 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:26,858 - WARNING - main_pipeline -       Error in fold 3 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:26,879 - WARNING - main_pipeline -       Error in fold 4 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:26,898 - WARNING - main_pipeline -       Error in fold 5 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:26,898 - INFO - main_pipeline - 
   Evaluating Decision Tree...
2026-01-16 19:18:26,948 - WARNING - main_pipeline -       Error in fold 1 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:26,967 - WARNING - main_pipeline -       Error in fold 2 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:26,989 - WARNING - main_pipeline -       Error in fold 3 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:27,003 - WARNING - main_pipeline -       Error in fold 4 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:27,018 - WARNING - main_pipeline -       Error in fold 5 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:27,019 - INFO - main_pipeline - 
   Evaluating Random Forest...
2026-01-16 19:18:27,064 - WARNING - main_pipeline -       Error in fold 1 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:27,083 - WARNING - main_pipeline -       Error in fold 2 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:27,096 - WARNING - main_pipeline -       Error in fold 3 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:27,111 - WARNING - main_pipeline -       Error in fold 4 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:27,126 - WARNING - main_pipeline -       Error in fold 5 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:18:27,127 - INFO - main_pipeline - 
   Evaluating CNN...
2026-01-16 19:18:27,161 - WARNING - main_pipeline -       Error in fold 1 for CNN: Model must be fitted before prediction
2026-01-16 19:18:27,176 - WARNING - main_pipeline -       Error in fold 2 for CNN: Model must be fitted before prediction
2026-01-16 19:18:27,194 - WARNING - main_pipeline -       Error in fold 3 for CNN: Model must be fitted before prediction
2026-01-16 19:18:27,211 - WARNING - main_pipeline -       Error in fold 4 for CNN: Model must be fitted before prediction
2026-01-16 19:18:27,227 - WARNING - main_pipeline -       Error in fold 5 for CNN: Model must be fitted before prediction
2026-01-16 19:18:27,227 - INFO - main_pipeline - 
   Evaluating TabNet...
2026-01-16 19:18:27,264 - WARNING - main_pipeline -       Error in fold 1 for TabNet: Model must be fitted before prediction
2026-01-16 19:18:27,278 - WARNING - main_pipeline -       Error in fold 2 for TabNet: Model must be fitted before prediction
2026-01-16 19:18:27,290 - WARNING - main_pipeline -       Error in fold 3 for TabNet: Model must be fitted before prediction
2026-01-16 19:18:27,306 - WARNING - main_pipeline -       Error in fold 4 for TabNet: Model must be fitted before prediction
2026-01-16 19:18:27,319 - WARNING - main_pipeline -       Error in fold 5 for TabNet: Model must be fitted before prediction
2026-01-16 19:18:27,321 - INFO - main_pipeline - 
   Saved evaluation results to output/phase3_evaluation/evaluation_results.csv
2026-01-16 19:18:27,322 - WARNING - main_pipeline -    Error generating dimension scores: 'model_name'
2026-01-16 19:18:27,322 - INFO - main_pipeline - 
3.2 Generating algorithm reports...
2026-01-16 19:18:27,322 - INFO - main_pipeline -    Algorithm reports generated
2026-01-16 19:18:27,322 - INFO - main_pipeline - 
3.3 Generating visualizations...
2026-01-16 19:18:27,336 - WARNING - main_pipeline - Error generating visualizations: 'f1_score'
Traceback (most recent call last):
  File "/home/tor/ton_iot/ton_iot/src/main_pipeline.py", line 309, in _generate_visualizations
    ax.bar([i - width for i in x], results_df['f1_score'], width, label='F1 Score', color='#1f77b4')
                                   ~~~~~~~~~~^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/.toniot/lib/python3.12/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/.toniot/lib/python3.12/site-packages/pandas/core/indexes/range.py", line 417, in get_loc
    raise KeyError(key)
KeyError: 'f1_score'
2026-01-16 19:18:27,338 - INFO - main_pipeline -    Visualizations generated
2026-01-16 19:18:27,348 - ERROR - __main__ - Error in pipeline execution: 'f1_score'
Traceback (most recent call last):
  File "/home/tor/ton_iot/ton_iot/main.py", line 243, in main
    pipeline.run()
  File "/home/tor/ton_iot/ton_iot/src/main_pipeline.py", line 479, in run
    ranking_results = self.phase5_ranking(evaluation_results)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/src/main_pipeline.py", line 438, in phase5_ranking
    evaluation_results['f1_score'].values,  # Dimension 1: Detection Performance
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/.toniot/lib/python3.12/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/.toniot/lib/python3.12/site-packages/pandas/core/indexes/range.py", line 417, in get_loc
    raise KeyError(key)
KeyError: 'f1_score'
2026-01-16 19:18:27,348 - ERROR - __main__ - See log file for full traceback
