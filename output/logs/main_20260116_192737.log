2026-01-16 19:27:37,396 - INFO - __main__ - Logging initialized. Log file: output/logs/main_20260116_192737.log
2026-01-16 19:27:37,396 - INFO - __main__ - ======================================================================
2026-01-16 19:27:37,397 - INFO - __main__ - IRP RESEARCH PIPELINE
2026-01-16 19:27:37,397 - INFO - __main__ - AI-Powered Log Analysis for Smarter Threat Detection
2026-01-16 19:27:37,397 - INFO - __main__ - ======================================================================
2026-01-16 19:27:37,397 - INFO - __main__ - Output directory: /home/tor/ton_iot/ton_iot/output
2026-01-16 19:27:37,397 - INFO - __main__ - Timestamp: 2026-01-16 19:27:37
2026-01-16 19:27:37,397 - INFO - __main__ - Checking Python dependencies from requirements.txt...
2026-01-16 19:27:37,737 - INFO - __main__ - All required packages are installed.
2026-01-16 19:27:37,737 - INFO - __main__ - Running complete pipeline (Phases 1, 3, 5)
2026-01-16 19:27:40,964 - INFO - main_pipeline - Pipeline initialized with output directory: /home/tor/ton_iot/ton_iot/output
2026-01-16 19:27:40,964 - INFO - __main__ - Starting complete pipeline execution...
2026-01-16 19:27:40,964 - INFO - main_pipeline - ============================================================
2026-01-16 19:27:40,964 - INFO - main_pipeline - PHASE 1: Preprocessing Configuration Selection
2026-01-16 19:27:40,964 - INFO - main_pipeline - ============================================================
2026-01-16 19:27:40,964 - INFO - main_pipeline - 
1.1 Loading datasets...
2026-01-16 19:27:40,964 - INFO - dataset_loader - Loading TON_IoT dataset from: datasets/ton_iot/train_test_network.csv
2026-01-16 19:27:41,546 - INFO - dataset_loader - TON_IoT loaded: 211043 rows, 44 columns
2026-01-16 19:27:41,546 - INFO - main_pipeline -    TON_IoT: (211043, 44)
2026-01-16 19:27:41,546 - WARNING - main_pipeline -    CIC-DDoS2019 not available, using TON_IoT only
2026-01-16 19:27:41,581 - INFO - main_pipeline -    Features shape: (211043, 43), Labels shape: (211043,)
2026-01-16 19:27:41,582 - INFO - main_pipeline - 
1.4 Preprocessing (SMOTE + RobustScaler)...
2026-01-16 19:27:41,582 - INFO - main_pipeline -    Applying SMOTE for class balancing...
2026-01-16 19:27:41,582 - INFO - main_pipeline -    Scaling features with RobustScaler...
2026-01-16 19:27:48,698 - INFO - main_pipeline -    Processed shape: (322086, 19)
2026-01-16 19:27:48,700 - INFO - main_pipeline -    Class distribution: {1: 161043, 0: 161043}
2026-01-16 19:27:52,566 - INFO - main_pipeline - 
   Saved preprocessed data to output/phase1_preprocessing/preprocessed_data.csv
2026-01-16 19:27:52,582 - INFO - main_pipeline - 
3.1 Evaluating 5 algorithms with 5-fold CV...
2026-01-16 19:27:52,584 - INFO - main_pipeline - 
   Evaluating Logistic Regression...
2026-01-16 19:27:52,622 - WARNING - main_pipeline -       Error in fold 1 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,647 - WARNING - main_pipeline -       Error in fold 2 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,677 - WARNING - main_pipeline -       Error in fold 3 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,698 - WARNING - main_pipeline -       Error in fold 4 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,725 - WARNING - main_pipeline -       Error in fold 5 for Logistic Regression: This LogisticRegression instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,725 - INFO - main_pipeline - 
   Evaluating Decision Tree...
2026-01-16 19:27:52,765 - WARNING - main_pipeline -       Error in fold 1 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,788 - WARNING - main_pipeline -       Error in fold 2 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,812 - WARNING - main_pipeline -       Error in fold 3 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,837 - WARNING - main_pipeline -       Error in fold 4 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,861 - WARNING - main_pipeline -       Error in fold 5 for Decision Tree: This DecisionTreeClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,861 - INFO - main_pipeline - 
   Evaluating Random Forest...
2026-01-16 19:27:52,926 - WARNING - main_pipeline -       Error in fold 1 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,955 - WARNING - main_pipeline -       Error in fold 2 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:52,988 - WARNING - main_pipeline -       Error in fold 3 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:53,021 - WARNING - main_pipeline -       Error in fold 4 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:53,057 - WARNING - main_pipeline -       Error in fold 5 for Random Forest: This RandomForestClassifier instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2026-01-16 19:27:53,058 - INFO - main_pipeline - 
   Evaluating CNN...
2026-01-16 19:27:53,101 - WARNING - main_pipeline -       Error in fold 1 for CNN: Model must be fitted before prediction
2026-01-16 19:27:53,131 - WARNING - main_pipeline -       Error in fold 2 for CNN: Model must be fitted before prediction
2026-01-16 19:27:53,159 - WARNING - main_pipeline -       Error in fold 3 for CNN: Model must be fitted before prediction
2026-01-16 19:27:53,185 - WARNING - main_pipeline -       Error in fold 4 for CNN: Model must be fitted before prediction
2026-01-16 19:27:53,210 - WARNING - main_pipeline -       Error in fold 5 for CNN: Model must be fitted before prediction
2026-01-16 19:27:53,211 - INFO - main_pipeline - 
   Evaluating TabNet...
2026-01-16 19:27:53,254 - WARNING - main_pipeline -       Error in fold 1 for TabNet: Model must be fitted before prediction
2026-01-16 19:27:53,276 - WARNING - main_pipeline -       Error in fold 2 for TabNet: Model must be fitted before prediction
2026-01-16 19:27:53,298 - WARNING - main_pipeline -       Error in fold 3 for TabNet: Model must be fitted before prediction
2026-01-16 19:27:53,322 - WARNING - main_pipeline -       Error in fold 4 for TabNet: Model must be fitted before prediction
2026-01-16 19:27:53,344 - WARNING - main_pipeline -       Error in fold 5 for TabNet: Model must be fitted before prediction
2026-01-16 19:27:53,346 - INFO - main_pipeline - 
   Saved evaluation results to output/phase3_evaluation/evaluation_results.csv
2026-01-16 19:27:53,346 - WARNING - main_pipeline -    Error generating dimension scores: 'model_name'
2026-01-16 19:27:53,347 - INFO - main_pipeline - 
3.2 Generating algorithm reports...
2026-01-16 19:27:53,347 - INFO - main_pipeline -    Algorithm reports generated
2026-01-16 19:27:53,347 - INFO - main_pipeline - 
3.3 Generating visualizations...
2026-01-16 19:27:53,359 - WARNING - main_pipeline - Error generating visualizations: 'f1_score'
Traceback (most recent call last):
  File "/home/tor/ton_iot/ton_iot/src/main_pipeline.py", line 309, in _generate_visualizations
    ax.bar([i - width for i in x], results_df['f1_score'], width, label='F1 Score', color='#1f77b4')
                                   ~~~~~~~~~~^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/.toniot/lib/python3.12/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/.toniot/lib/python3.12/site-packages/pandas/core/indexes/range.py", line 417, in get_loc
    raise KeyError(key)
KeyError: 'f1_score'
2026-01-16 19:27:53,361 - INFO - main_pipeline -    Visualizations generated
2026-01-16 19:27:53,367 - ERROR - __main__ - Error in pipeline execution: 'f1_score'
Traceback (most recent call last):
  File "/home/tor/ton_iot/ton_iot/main.py", line 267, in main
    pipeline.run()
  File "/home/tor/ton_iot/ton_iot/src/main_pipeline.py", line 479, in run
    ranking_results = self.phase5_ranking(evaluation_results)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/src/main_pipeline.py", line 438, in phase5_ranking
    evaluation_results['f1_score'].values,  # Dimension 1: Detection Performance
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/.toniot/lib/python3.12/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tor/ton_iot/ton_iot/.toniot/lib/python3.12/site-packages/pandas/core/indexes/range.py", line 417, in get_loc
    raise KeyError(key)
KeyError: 'f1_score'
2026-01-16 19:27:53,368 - ERROR - __main__ - See log file for full traceback
